(function(){"use strict";var $window=$(window),$body=$("body"),$panes=$(".pane"),$navbar=$("#main-navbar"),$navbarBrand=$(".navbar-brand"),$scrollWrapper=$("#scroll-wrapper"),$paneTitleLink=$(".pane-title-block a"),$linkNewsEvents=$("#link-news-and-events"),$backToMenuLink=$(".back-to-main-menu"),$expandMenuLink=$("#expand-menu-link"),$overflowWrapper=$(".overflow-wrapper"),$contentWrappers=$(".content-wrapper"),$paneContentLink=$(".pane-content a");var isShowingContent=false,hasActivePane=false,activePane=null,menuPane=false,offset=0,panes=[],view={};$overflowWrapper.find(".no-scroll").removeClass("no-scroll").addClass("horizontal-scroll-wrapper");function recalcViewport(){view.height=$window.height();view.width=$window.width()}recalcViewport();function fixPanesHeight(){$scrollWrapper.height($window.height()-$navbar.outerHeight())}fixPanesHeight();$window.on("resize",fixPanesHeight);var pointerLeft=0;$window.mousemove(function(e){pointerLeft=e.pageX;window.requestAnimationFrame(scrollCalc)});$panes.on("click",function(e){var pane=$(this);$panes.removeClass("selected");pane.addClass("selected");activePane=pane[0].id;hasActivePane=true});$panes.on("dblclick",function(e){$panes.removeClass("selected");activePane=null;hasActivePane=false});$paneTitleLink.on("click",function(e){if(!hasActivePane)return;var clickedPane=$(this).parent().parent()[0].id;if(clickedPane!==activePane)return;setTimeout(function(){var activeContent=clickedPane.replace("pane","content");hasActivePane=true;$panes.removeClass("selected");$("#"+activePane).addClass("selected");toggleShowContent("#"+activePaneContent)},10);e.preventDefault()});var shouldReload=true;$paneContentLink.on("click",function(e){console.debug("$paneContentLink click");var target_pane=$(e.target).closest(".pane").attr("id");bringPaneIntoView(target_pane);if(shouldReload){setTimeout(function(){$.stellar("refresh")},100);shouldReload=false}if(isShowingContent){setTimeout(function(){$body.toggleClass("expanded-menu")},1e3);return}toggleShowContent()});$navbarBrand.on("click",toggleShowContent);$backToMenuLink.on("click",function(e){console.debug("$backToMenuLink");e.preventDefault();setTimeout(function(){$panes.removeClass("selected");$body.removeClass("expanded-menu");activePane=null;hasActivePane=false},10);toggleShowContent()});$('a[href="#"]').on("click",function(e){e.preventDefault()});$.stellar({horizontalScrolling:false,hideDistantElements:false,verticalScrolling:true,verticalOffset:view.height/2,responsive:true});$expandMenuLink.on("click",function(e){$body.toggleClass("expanded-menu")});function toggleShowContent(contentPaneId){console.log("contentPaneId:",contentPaneId);isShowingContent=!isShowingContent;if(isShowingContent){scrollCalc();if(contentPaneId)showPaneConent(contentPaneId);return $body.addClass("show-content")}$body.removeClass("show-content")}function showPaneConent(pageId){$(".content-wrapper").hide();$(pageId).show()}function getPanes(){console.debug("getPanes");$panes.each(function(index,pane){panes.push(pane.id)})}getPanes();function scrollCalc(){if(isShowingContent){console.log("isShowingContent:",isShowingContent);console.log("menuPane:",menuPane);if(menuPane!==false){offset=menuPane*view.width/4}else{if(0===offset)return;offset=0}}else{offset=Math.min(.5*Math.max(pointerLeft-view.width/4,0),view.width/4)}$scrollWrapper.css("transform","translateX("+-offset+"px)")}$(".next").on("click",function(){if(menuPane===4)return menuPane=0;menuPane++});$(".prev").on("click",function(){if(menuPane===0)return menuPane=4;menuPane--});function bringPaneIntoView(pane_id){var pane_index=panes.indexOf(pane_id);if(menuPane===pane_index)return;setTimeout(function(){$.stellar("refresh")},1e3);menuPane=pane_index;scrollCalc()}})();$(function(){$('a[href*="#"]:not([href="#"])').click(function(e){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var target=$(this.hash);target=target.length?target:$("[name="+this.hash.slice(1)+"]");if(!target.length)return;$("html,body").animate({scrollTop:target.offset().top-51},800);e.preventDefault()}})});
